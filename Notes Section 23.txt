23-512. Creating a GitHub Action ~ 513. Adding a CI Test Script
https://docs.github.com/en/github-ae@latest/actions/using-workflows/events-that-trigger-workflows

### Github => Choose Repository => Actions => Yourself
https://github.com/christseng89/Microservices-with-Node-JS-and-React/new/master?filename=.github%2Fworkflows%2Fmain.yml&workflow_template=blank

// tests.yaml
name: tests

on: pull_request

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: cd auth && npm install && npm run test:ci

### Auth
// package.json
    "test": "jest --runInBand --detectOpenHandles --watchAll --no-cache",
    "test:ci": "jest" ***

git add .
git commit -am "23-512. Creating a GitHub Action ~ 513. Adding a CI Test Script"
git pull
git push

23-514. Running Tests on PR Creation
### Auth
index.ts
const start = async () => {
  console.log('Starting up ...'); ***
  if (!process.env.JWT_KEY) {

// Create a Branch
git checkout -b dev
  Switched to a new branch 'dev'    

git commit -am "23-514. Running Tests on PR Creation #1"
git push origin dev

// tests.yaml
      - run: cd ticketing && cd auth && npm install && npm run test:ci ***
git push origin dev

### Github => Pull Requests => New Pull Request => master <- dev

23-515. Output of Failing Tests
// signin.test.ts
it('responds with a cookie when given valid credentials', async () => {
  const cookie = await global.signup();
  const response = await request(app)
    .post('/api/users/signin')
    .send({
      email: 'test@test.com',
      password: 'password'
    })
    .expect(400); ***

git commit -am "23-515. Output of Failing Tests #1"
git push origin dev

// signin.test.ts
it('responds with a cookie when given valid credentials', async () => {
  const cookie = await global.signup();
  const response = await request(app)
    .post('/api/users/signin')
    .send({
      email: 'test@test.com',
      password: 'password'
    })
    .expect(200); ***

git commit -am "23-515. Output of Failing Tests #2"
git push origin dev

### Manually create a PR (Pull Request) once.  CI will run automatically.

23-516. Running Tests in Parallel
// package.json (tickets, orders, payments)
    "test:ci": "jest" ***

// package.json (expiration)
  "scripts": {
    "start": "ts-node-dev src/index.ts"
  },

git commit -am "23-516. Running Tests in Parallel #1"
git push origin dev

### .github\workflows
ren tests.yaml => tests-auth.yaml
// tests-tickets.yaml, tests-orders.yaml, tests-payments.yaml (new)

git add .
git commit -am "23-516. Running Tests in Parallel #2"
git push origin dev

### Add stripe-key.ts (temporary)
git add .
git commit -am "23-516. Running Tests in Parallel #3"
git push origin dev

### PULL REQUEST by using CLI
git branch
  * dev
    master

git push origin dev:master
git switch master
git branch
    dev
  * master
git pull

23-518. Selective Test Execution
git switch dev
git branch
git pull origin master

### Revise tests-xxxx.yaml
on:
  pull_request:
    paths:
      - 'ticketing/xxxx/**'

git add .
git commit -am "23-518. Selective Test Execution"
git push origin dev
### Merge dev => master
git push origin dev:master
git pull origin master

### Payments
index.ts
const start = async () => {
  console.log('Starting up ...');  ***

git commit -am "23-518. Selective Test Execution #2"
git push origin dev
git switch master
git merge dev master
git push origin dev:master

https://github.com/christseng89/Microservices-with-Node-JS-and-React/settings/branches
  v Require a pull request before merging

git commit -am "23-518. Selective #3"
git push origin dev
git merge dev master  

git commit -am "23-518. Selective #4"
git push origin dev
git merge dev master  

https://github.com/christseng89/Microservices-with-Node-JS-and-React/settings/branches
  x Require a pull request before merging

git commit -am "23-518. Selective #5"
git push origin dev

### Delete branch
git switch master
git pull
git branch -d dev
  Deleted branch dev (was 5a8a3b1).
git branch
    JeffWang
  * master  

// update auth\index.ts
git commit -am "23-518. Selective #6"
git push origin master

https://github.com/christseng89/Microservices-with-Node-JS-and-React/settings/branches
  v Require a pull request before merging
  
// update auth\index.ts
git commit -am "23-518. Selective #7"
git push origin master
